<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js" integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>login</title>
</head>

<body>
    <header id="header"></header>

    <section class="loginContainer">

        <div class="regLogo">
            <img src="Assets/Images/gift.png" alt="none">
            <p>Gift Corner</p><br>
        </div>
        <form onsubmit="login()">
            <div class="field">
                
                    <input type="email" required autocomplete="off" id="loginEmail" placeholder="E-mail">
                    <label for="loginEmail" title="E-mail"></label>
            </div>
            <div class="field">
                <input type="password" required autocomplete="off" id="loginPassword">
                <label for="loginPassword" title="password"></label>
            </div>
            <button type="submit">login</button>
        </form>


    </section>
    <!-- java script -->
    <script src="Assets/js/jquery.min.js"></script>
    <script>
        function login() {
            let credi
            event.preventDefault();
            const email = document.querySelector("#loginEmail").value;
            const password = document.querySelector("#loginPassword").value;
            
            if(email ==""||email==null||email.trim()==""){
                alert("invalid username");
            }
            else{
            if(password.trim() != ""){

               const loginobj = {
                "email": email,
                "password": password 
               };

                //sending data to server
                const url = "https://product-mock-api.herokuapp.com/giftshopapp/api/v1/auth/login";

                console.log(loginobj);//for our verification

                axios.post(url,loginobj).then(res=>{
                    console.log(res);

                    //to stay loged in
                    // let user = res.data;
                    // localStorage.setItem("LOGGED_IN_USER", JSON.stringify(user));

                    alert("login succesful");
                    window.location.href="index.html";
                }).catch(err=>{
                        console.log(err.response.data);
                        if (err.response.data.errorMessage){
                            alert(err.response.data.errorMessage);
                        }
                        else{
                        alert("login failed");
                        }
                });
            
            }
            else{
                alert("password is invalid");
            }
        }
    

}
        $("#header").load("header.html")
    </script>
</body>

</html>