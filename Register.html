<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
        integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>Register</title>
</head>

<body>

    <header id="header"></header>


    <section class="Registercontainer">

        <div class="Reglogo">
            <img src="Assets/Images/gift.png" alt="">
            <!-- <img class="regimg" src="Assets/Images/gift.png" alt=""> -->
            <p>Gift corner</p><br>
        </div>

        <form onsubmit="register()">
            <div class="field">
                <input type="text" required autocomplete="off" id="name">
                <label for="name" title="Name"></label>
            </div>
            <div class="field">
                <div class="email">
                    <input type="email" required autocomplete="off" id="email" placeholder="email">
                    <label for="email" title="email"></label>
                </div>
            </div>
            <div class="field">
                <input type="password" required autocomplete="off" id="password">
                <label for="password" title="password"></label>
            </div>
            <div class="field">
                <input type="password" required autocomplete="off" id="confirm">
                <label for="confirm" title="confirm"></label>
            </div>
            <button type="submit">Register</button>

        </form>

    </section>

    <!-- java script -->

    <script src="Assets/js/jquery.min.js"></script>
    <script>
        $("#header").load("header.html")

        function register() {
            event.preventDefault();
            const name = document.querySelector("#name").value;
            const email = document.querySelector("#email").value;
            const password = document.querySelector("#password").value;
            const confirm = document.querySelector("#confirm").value;
            // if name is valid or not
            if (name == "" || name == null || name.trim() == "") {
                alert("invalid name");
            }
            if (password.length < 8) {
                alert("password is short");
            }

            else 
                if (password != confirm) {
                    alert("password doesnot match");
                }
                   
                else {
                     // backend
                     let usrobj = {
                        "name": name,
                        "email": email,
                        "password": password,
                        "role": "USER"
                    };

                    console.log(usrobj); //for printing in console 

                    const url = "https://product-mock-api.herokuapp.com/giftshopapp/api/v1/auth/register";//registration url
                    axios.post(url, usrobj).then(res => {

                        console.log(res);//printing in console // for user purpose
                        alert("Registration is succesful");


                        window.location.href = "login.html";
                    }).catch(err => {
                        console.error(err);
                        alert("Unable to register");
                    });

                }
                }
        
        
        
    </script>
</body>

</html>